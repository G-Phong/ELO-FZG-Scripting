<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="de">
<head>
<!-- Generated by javadoc -->
<title>IDBConnectionHandler (ELO IndexServer Documentation)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="declaration: package: de.elo.ix.jscript.handler, interface: IDBConnectionHandler">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../../script-dir/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../../script-dir/jquery-3.4.1.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.js"></script>
</head>
<body class="class-declaration">
<script type="text/javascript">var data = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6,"i8":6,"i9":6,"i10":6,"i11":6,"i12":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flexBox">
<header role="banner" class="flexHeader">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<div class="navListSearch"><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="skipNav"><a id="skip.navbar.top">
<!--   -->
</a></div>
</nav>
</header>
<div class="flexContent">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">de.elo.ix.jscript.handler</a></div>
<h1 title="Interface IDBConnectionHandler" class="title">Interface IDBConnectionHandler</h1>
</div>
<div class="contentContainer">
<section class="description">
<dl>
<dt>All Superinterfaces:</dt>
<dd><code>de.elo.ix.db.schema.IDBConnection</code></dd>
</dl>
<hr>
<pre>public interface <span class="typeNameLabel">IDBConnectionHandler</span>
extends de.elo.ix.db.schema.IDBConnection</pre>
<div class="block">Internally used interface.
 Class DBConnection forwards method calls to an implementation of this interface. 
 The implementation is only available when we are running as a IX event script or plugin.</div>
</section>
<section class="summary">
<ul class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li class="blockList">
<section class="nestedClassSummary"><a id="nested.class.summary">
<!--   -->
</a>
<h2>Nested Class Summary</h2>
<div class="memberSummary">
<table>
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor">
<td class="colFirst"><code>static interface&nbsp;</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="IDBConnectionHandler.ResultSetWrapper.html" title="interface in de.elo.ix.jscript.handler">IDBConnectionHandler.ResultSetWrapper</a></span></code></th>
<td class="colLast">
<div class="block">Wrapper class for the JDBC ResultSet.</div>
</td>
</tr>
</tbody>
</table>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li class="blockList">
<section class="methodSummary"><a id="method.summary">
<!--   -->
</a>
<h2>Method Summary</h2>
<div class="memberSummary">
<div role="tablist" aria-orientation="horizontal"><button role="tab" aria-selected="true" aria-controls="memberSummary_tabpanel" tabindex="0" onkeydown="switchTab(event)" id="t0" class="activeTableTab">All Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t2" class="tableTab" onclick="show(2);">Instance Methods</button><button role="tab" aria-selected="false" aria-controls="memberSummary_tabpanel" tabindex="-1" onkeydown="switchTab(event)" id="t3" class="tableTab" onclick="show(4);">Abstract Methods</button></div>
<div id="memberSummary_tabpanel" role="tabpanel">
<table aria-labelledby="t0">
<thead>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
</thead>
<tbody>
<tr class="altColor" id="i0">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#escapeString(java.lang.String)">escapeString</a></span>&#8203;(java.lang.String&nbsp;value)</code></th>
<td class="colLast">
<div class="block">Return an escaped String value to be used in a SQL statement.</div>
</td>
</tr>
<tr class="rowColor" id="i1">
<td class="colFirst"><code>java.lang.String</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#getDatabaseProductName()">getDatabaseProductName</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns the name of the Database product.</div>
</td>
</tr>
<tr class="altColor" id="i2">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isDB2()">isDB2</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true, if connected to DB2.</div>
</td>
</tr>
<tr class="rowColor" id="i3">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isMssql()">isMssql</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true, if connected to Mssql.</div>
</td>
</tr>
<tr class="altColor" id="i4">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isOracle()">isOracle</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true, if connected to Oracle.</div>
</td>
</tr>
<tr class="rowColor" id="i5">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#isPgsql()">isPgsql</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true, if connected to Mssql.</div>
</td>
</tr>
<tr class="altColor" id="i6">
<td class="colFirst"><code>java.sql.Connection</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#open()">open</a></span>()</code></th>
<td class="colLast">
<div class="block">Open a database connection.</div>
</td>
</tr>
<tr class="rowColor" id="i7">
<td class="colFirst"><code>java.lang.Object[][]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#query(java.lang.String)">query</a></span>&#8203;(java.lang.String&nbsp;sqlcmd)</code></th>
<td class="colLast">
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr class="altColor" id="i8">
<td class="colFirst"><code>java.lang.Object[][]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#query(java.lang.String,java.lang.Object)">query</a></span>&#8203;(java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;params)</code></th>
<td class="colLast">
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr class="rowColor" id="i9">
<td class="colFirst"><code>java.lang.Object[][]</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)">query</a></span>&#8203;(java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;params,
int&nbsp;max,
java.lang.Object&nbsp;binding)</code></th>
<td class="colLast">
<div class="block">Execute a SELECT command.</div>
</td>
</tr>
<tr class="altColor" id="i10">
<td class="colFirst"><code>java.lang.Integer</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#update(java.lang.String)">update</a></span>&#8203;(java.lang.String&nbsp;sqlcmd)</code></th>
<td class="colLast">
<div class="block">Executes an update, delete or insert command.</div>
</td>
</tr>
<tr class="rowColor" id="i11">
<td class="colFirst"><code>java.lang.Integer</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#update(java.lang.String,java.lang.Object)">update</a></span>&#8203;(java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;rows)</code></th>
<td class="colLast">
<div class="block">Executes an update, delete or insert command.</div>
</td>
</tr>
<tr class="altColor" id="i12">
<td class="colFirst"><code>java.lang.Integer</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#update(java.lang.String,java.lang.Object,java.lang.Object)">update</a></span>&#8203;(java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;rows,
java.lang.Object&nbsp;binding)</code></th>
<td class="colLast">
<div class="block">Executes an update, delete oder insert Statement.</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="inheritedList">
<h3>Methods inherited from interface&nbsp;de.elo.ix.db.schema.IDBConnection</h3>
<a id="methods.inherited.from.class.de.elo.ix.db.schema.IDBConnection">
<!--   -->
</a><code>schema</code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<li class="blockList">
<section class="methodDetails"><a id="method.detail">
<!--   -->
</a>
<h2>Method Details</h2>
<ul class="blockList">
<li class="blockList">
<section class="detail">
<h3><a id="getDatabaseProductName()">getDatabaseProductName</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">getDatabaseProductName</span>()
                                 throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Returns the name of the Database product.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isOracle()">isOracle</a></h3>
<div class="memberSignature"><span class="returnType">boolean</span>&nbsp;<span class="memberName">isOracle</span>()
          throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Returns true, if connected to Oracle.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
<dd><code>javax.naming.NamingException</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isDB2()">isDB2</a></h3>
<div class="memberSignature"><span class="returnType">boolean</span>&nbsp;<span class="memberName">isDB2</span>()
       throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Returns true, if connected to DB2.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isMssql()">isMssql</a></h3>
<div class="memberSignature"><span class="returnType">boolean</span>&nbsp;<span class="memberName">isMssql</span>()
         throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Returns true, if connected to Mssql.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="isPgsql()">isPgsql</a></h3>
<div class="memberSignature"><span class="returnType">boolean</span>&nbsp;<span class="memberName">isPgsql</span>()
         throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Returns true, if connected to Mssql.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>...</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>javax.naming.NamingException</code></dd>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="open()">open</a></h3>
<div class="memberSignature"><span class="returnType">java.sql.Connection</span>&nbsp;<span class="memberName">open</span>()
                  throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Open a database connection. 
 The returned database connections must be closed with a call to its close function.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Connection object</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="query(java.lang.String,java.lang.Object,int,java.lang.Object)">query</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Object[][]</span>&nbsp;<span class="memberName">query</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;params,
int&nbsp;max,
java.lang.Object&nbsp;binding)</span>
                    throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Execute a SELECT command.
 <p>
 This function executes a SQL SELECT command and returns an array of result rows, whereby each
 row is an array of Java objects.
 </p>
 <p>
 Three kinds of query strings in the parameter <code>sqlcmd</code> are supported:
 <ul>
 <li>Simple query without placeholders: <br/>
 Example: <br/>
 <code class="example">db.query("select objid from objekte where objshort like 'it''s my string'", undefined, 0, undefined); </code>
 <br/>
 This will execute the query "select objid from objekte where objshort like 'it''s my string'".<br/>
 </li>
 <li>Query with MessageFormat placeholders:<br/>
 The placeholders are substituted by a java.text.MessageFormat object.<br/>
 Example:<br/>
 <code class="example">db.query("select {1} from {0} where {2} like {3}", ["objekte", "objid", "objshort", "'it''s my string'"], 0, undefined);</code>
 <br/>
 This will execute the query "select objid from objekte where objshort like 'it''s my string'".<br/>
 <i>Hints:Placeholders inside apostrophes - like in "... where objshort like '{0}' ..." - are
 NOT substituted.</i></li>
 <li>Query with PreparedStatement placeholders:<br/>
 The placeholders are substituted by the JDBC driver.<br/>
 Example:<br/>
 <code class="example">db.query("select objid from objekte where objshort like ?", ["it's my string"], 0, undefined);</code>
 <br/>
 <i>Hint: Strings need not to be escaped.</i></li>
 </ul>
 </p>
 <p>
 Databases provide column data for some column types in a non-serializable Java class. E.g. the
 ORACLE database return both integers and doubles as Java BigDecimal objects. Thus it is not
 possible to distinguish between the types and automatically convert to Integer or Double
 without knowlege about the underlying column type definition. To handle this circumstance, a
 JavaScript object can be supplied in the parameter <code>binding</code> that invokes the getter
 functions of the ResultSet object. It has to define a <code>getResult</code> function as shown
 in the example below. The first parameter of the <code>getResult</code> function is a
 <code>DBConnectionHandler.ResultSetWrapper</code>
 </p>
 <p>
 The following JavaScript class is an example for the <code>binding</code> parameter.
 
 <pre>
 <code class="example">
 function Binding() { 
   this.getResult = function(row, column) {
     // column starts with 1 !
     switch (column) {
       case 1: return row.getString(column);
       case 2: return row.getInteger(column);
       case 3: return row.getBytes(column);
       default: throw "Invalid column";
     }
   };
 }
 
  function dbread() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var args = ["Stuttgart", 59];
    var ret = db.query("select name, age, passportphoto from employees where branch like ? and age &gt; ?", args, 0, new Binding());
    for (var i = 0; i < ret.length; i++) {
      log.info("name=" + ret[i][0] + ", age=" + ret[i][1] + ", photo.length=" + ret[i][2].length);
    }
    return ret;
  }
 </code>
 </pre>
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command string.</dd>
<dd><code>params</code> - Optional. This parameters are bound if sqlcmd contains placeholders.</dd>
<dd><code>max</code> - Optional. Maximum number of rows to be read. If 0, all selected rows are read.</dd>
<dd><code>binding</code> - Optional. This parameter can hold a JavaScript object that extracts the data of
          a selected column from the ResultSet object.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Java Object[] of rows. If more than one column is selected, each row element is an array of columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
<dd><code>javax.naming.NamingException</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>DBConnectionHandler.ResultSetWrapper</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="query(java.lang.String,java.lang.Object)">query</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Object[][]</span>&nbsp;<span class="memberName">query</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;params)</span>
                    throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Execute a SELECT command.
 This function calls <a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)"><code>query(String, Object, int, Object)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command.</dd>
<dd><code>params</code> - Optional. This parameters are bound if sqlcmd contains placeholders.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Matrix of rows and columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>SQLExcetpion</code></dd>
<dd><code>java.lang.Exception</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)"><code>query(String, Object, int, Object)</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="query(java.lang.String)">query</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Object[][]</span>&nbsp;<span class="memberName">query</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd)</span>
                    throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Execute a SELECT command.
 This function calls <a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)"><code>query(String, Object, int, Object)</code></a>.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SELECT command.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Matrix of rows and columns.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>SQLExcetpion</code></dd>
<dd><code>java.lang.Exception</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)"><code>query(String, Object, int, Object)</code></a></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="update(java.lang.String,java.lang.Object,java.lang.Object)">update</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Integer</span>&nbsp;<span class="memberName">update</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;rows,
java.lang.Object&nbsp;binding)</span>
                  throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Executes an update, delete oder insert Statement.
 <p>
 <ul>
 <li>If the SQL command does not contain placeholders, the rows argument must be null.</li>
 <li>If the SQL command contains MessageFormat placeholders like {0}, {1} etc. or the
 PreparedStatement placeholder ?, the rows parameter must not be null.</li>
 <li>If rows is a single Object or an array of Objects, this objects replace the placeholders
 and one database row is updated.</li>
 <li>If rows is an 2-dimensional array of Objects with the dimensions
 <code>rows[rowcount][colcount]</code>, the SQL command contains <code>colcount</code>
 placeholders and <code>rowcount</code> database rows are updated.</li>
 </ul>
 </p>
 <p>
 If the SQL command contains PreparedStatement placeholders, the function parameter <code>binding</code>
 can be supplied. A JavaScript object has to be passed that calls the setters of the internally used 
 JDBC PreparedStatement object. This allows the programmer e.g. to store binary data. The
 <code>binding</code> object has to be defined analogous to the binding object in the
 <a href="#query(java.lang.String,java.lang.Object,int,java.lang.Object)"><code>query(String, Object, int, Object)</code></a> function. Here is an example:<br>
 
 <pre>
 <code class="example">
 function Binding() {
   this.bindParam = function(row, col, obj) {
     switch (col) {
       case 1: return row.setString(col, obj);
       case 2: return row.setDouble(col, obj);
       case 3: return row.setInteger(col, obj);
       case 4: return row.setBytes(col, obj);
       default: throw "Invalid column";
     }
   }
 }
 
  function dbinsert() {
    var db = new Packages.de.elo.ix.jscript.DBConnection( "jdbc/MyDB2", "TESTSCHEMA" );
    var photos = [ ... bytes ... , ... bytes ... ]; 
    var args = [["Fritz", 54321.22, 38, photos[0]],["Maria", 65432.11, 43, photos[1]]];
    var ret = db.update("insert into employees (name, salary, age, passportphoto) values (?, ?, ?, ?)", args, new Binding());
    log.info("number of inserted rows=" + ret); // == 2
    return ret;
 }
 </code>
 </pre>
 
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dd><code>rows</code> - Optional. Data to be written or parameters if the sqlcmd contains placeholders.</dd>
<dd><code>binding</code> - Optional. This parameter can hold a JavaScript object that passes the data of a
          selected column into a PreparedStatement object.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><code>DBConnectionHandler.PreparedStatementWrapper</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="update(java.lang.String)">update</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Integer</span>&nbsp;<span class="memberName">update</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd)</span>
                  throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Executes an update, delete or insert command.
 This function calls <a href="#update(java.lang.String,java.lang.Object,java.lang.Object)"><code>update(String, Object, Object)</code></a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="update(java.lang.String,java.lang.Object)">update</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.Integer</span>&nbsp;<span class="memberName">update</span>&#8203;(<span class="arguments">java.lang.String&nbsp;sqlcmd,
java.lang.Object&nbsp;rows)</span>
                  throws <span class="exceptions">java.lang.Exception</span></div>
<div class="block">Executes an update, delete or insert command.
 This function calls <a href="#update(java.lang.String,java.lang.Object,java.lang.Object)"><code>update(String, Object, Object)</code></a></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sqlcmd</code> - SQL command.</dd>
<dd><code>rows</code> - see <a href="#update(java.lang.String,java.lang.Object,java.lang.Object)"><code>update(String, Object, Object)</code></a></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Number of modified rows.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.Exception</code></dd>
</dl>
</section>
</li>
<li class="blockList">
<section class="detail">
<h3><a id="escapeString(java.lang.String)">escapeString</a></h3>
<div class="memberSignature"><span class="returnType">java.lang.String</span>&nbsp;<span class="memberName">escapeString</span>&#8203;(<span class="arguments">java.lang.String&nbsp;value)</span></div>
<div class="block">Return an escaped String value to be used in a SQL statement.
 Places an apostrophe before and after the given String and replaces every apostrophe in the string with two apostrophes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>value</code> - String value to be escaped.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Escaped String value.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
</div>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
<p class="legalCopy"><small><i>Copyright &#169; ELO Digital Office GmbH. All Rights Reserved.</i></small></p>
</footer>
</div>
</div>
</body>
</html>
